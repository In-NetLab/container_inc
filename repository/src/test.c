#include "util.h"
#include <stdio.h>

uint8_t pack[1024] = {
    0x52, 0x54, 0x00, 0xdf, 0x0c, 0x28, // src mac
    0x52, 0x54, 0x00, 0xba, 0xc7, 0x53, // dst mac
    0x08, 0x00, // ethertype
    0x45, 0x00, // version + ihl
    0x00, 0x30, // tos
    0x26, 0x95,
    0x40, 0x00,
    0x40, 0x11,
    0x90, 0x86,
    0x0a, 0x32, 0xb7, 0xab,
    0x0a, 0x32, 0xb7, 0x92,
    0xd1, 0xd5,
    0x12, 0xb7,
    0x00, 0x1c,
    0x00, 0x00,
    0x11, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x11, 0x00, 0x00, 0x00, 0x00, 0x1f, 0x00, 0x00, 0x01,
    // 0xe8, 0xb0, 0xbb, 0x30
};

int main(){
    for(int i = 0; i < 62; i++) {
        printf("%02x ", (unsigned char)pack[i]);
    }
    printf("\n");
    uint32_t crc = compute_icrc(0, pack);
    printf("icrc: 0x%08X\n", crc);

    uint32_t* icrc = (uint32_t*)(pack + 62 - 4);
    *icrc = crc;

    for(int i = 0; i < 62; i++) {
        printf("%02x ", (unsigned char)pack[i]);
    }
    printf("\n");
}